# 跑在 Thinkpad T470s 上的'肥刺鱼'


## Thinkpad T470s

TODO


## Install OpenBSD 7.8

一眨眼，OpenBSD 7.8 都出来了。

![](images/2024_08_29_openbsd_7.8_on_thinkpad_t470s/puffy78.gif)

折腾了半天，终于装好了 OpenBSD 7.8，记录下安装过程，备忘。

OpenBSD FAQ 就是 handbook。
[http://www.openbsd.org/faq/index.html][1]

Ctrl + Alt + F1~F6，默认的六个 console。


### Install from USB

将 [install78.img][2] 刻录到U盘

* [https://mirrors.tuna.tsinghua.edu.cn/OpenBSD/7.8/amd64/install78.img][2]
* windows 下，用 [https://sourceforge.net/projects/win32diskimager/][3]
* openbsd 下，参见 [http://www.openbsd.org/faq/faq4.html#MkInsMedia][4]

安装步骤

* 启动电脑，按 Enter 按钮，然后 F12，用 USB 启动。
* 一路 Next 下来。
* 记得在安装 distribution sets 时，选择 disk，然后选择 sd1，作为安装媒介。


### Install fireware

```
方法一：
  a) 插上有线网络
  b) fw_update -p http://firmware.openbsd.org/firmware/6.0/
方法二：
  a) 下载所有 firmware，用 U盘 复制到 openbsd 机器上
  b) fw_update -p /path/to/firmware
搞定。

参考 wpi, fw_update 的 man page。
```


### Config wireless network

ifconfig 看到无线网卡名叫 iwm0。然后
man iwm，看看如何配置。

```
# ifconfig iwm0 nwid YourNetworkName wpakey YourNetworkPassword
# ifconfig iwm0 inet autoconf
```

搞定，网络通。

写配置文件 hostname.iwm0，下次机器启动，保证网络正常。

```
# cat /etc/hostname.wpi0
join YourNetworkName wpakey YourNetworkPassword
inet autoconf

# chmod o-r /etc/hostname.wpi0       # 去掉 other 的 read 权限，安全一点
# reboot
```


## FAQ

### 新系统组件(distribution sets)

用安装盘启用，然后选择 Upgrade。参考：

* [http://www.openbsd.org/faq/faq4.html#FilesNeeded][6]


### pkg_info 提示 tls handshake failure

系统时间不对，rdate 同步下。

```
rdate -4n pool.ntp.org
```


[1]:http://www.openbsd.org/faq/index.html
[2]:https://mirrors.tuna.tsinghua.edu.cn/OpenBSD/7.8/amd64/install78.img
[3]:https://sourceforge.net/projects/win32diskimager/
[4]:http://www.openbsd.org/faq/faq4.html#MkInsMedia
[5]:http://firmware.openbsd.org/firmware/6.0/
[6]:http://www.openbsd.org/faq/faq4.html#FilesNeeded
